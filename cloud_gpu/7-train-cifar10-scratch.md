# Goal: 理解如何从0开始train一个数据集碰到的问题

## Key Result
 **0.83**

> same padding is important
> fc two layer make thing better
> save weight then train again，ckpt很重要
> 加入fc1024xfc1024后，很容易overfitting，需要使用更强的dropout
> dropout需要提前部署，否则泛化能力上不去
> SGD和Adam的表现很不同

## train1
## arch: 32/16/8/4/2 Conv layer
```
conv2d_26 (Conv2D)           (None, 32, 32, 32)        896       
_________________________________________________________________
activation_31 (Activation)   (None, 32, 32, 32)        0         
_________________________________________________________________
max_pooling2d_26 (MaxPooling (None, 16, 16, 32)        0         
_________________________________________________________________
conv2d_27 (Conv2D)           (None, 16, 16, 64)        18496     
_________________________________________________________________
activation_32 (Activation)   (None, 16, 16, 64)        0         
_________________________________________________________________
max_pooling2d_27 (MaxPooling (None, 8, 8, 64)          0         
_________________________________________________________________
conv2d_28 (Conv2D)           (None, 8, 8, 128)         73856     
_________________________________________________________________
activation_33 (Activation)   (None, 8, 8, 128)         0         
_________________________________________________________________
max_pooling2d_28 (MaxPooling (None, 4, 4, 128)         0         
_________________________________________________________________
conv2d_29 (Conv2D)           (None, 4, 4, 256)         295168    
_________________________________________________________________
activation_34 (Activation)   (None, 4, 4, 256)         0         
_________________________________________________________________
max_pooling2d_29 (MaxPooling (None, 2, 2, 256)         0         
_________________________________________________________________
conv2d_30 (Conv2D)           (None, 2, 2, 512)         1180160   
_________________________________________________________________
activation_35 (Activation)   (None, 2, 2, 512)         0         
_________________________________________________________________
max_pooling2d_30 (MaxPooling (None, 1, 1, 512)         0         
_________________________________________________________________
flatten_6 (Flatten)          (None, 512)               0         
_________________________________________________________________
dense_6 (Dense)              (None, 64)                32832     
_________________________________________________________________
activation_36 (Activation)   (None, 64)                0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 64)                0         
_________________________________________________________________
predictions (Dense)          (None, 10)                650       
=================================================================
Total params: 1,602,058
Trainable params: 1,602,058
Non-trainable params: 0
```

### results:

> accu 0.92 vs. 0.76 @e30
> overfitting
> 前几层过早的max pooling

# train 2: better arch & more dropout

### arch
```
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_1 (Conv2D)            (None, 30, 30, 32)        896       
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 28, 28, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 14, 14, 64)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 14, 14, 64)        0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 14, 14, 128)       73856     
_________________________________________________________________
activation_1 (Activation)    (None, 14, 14, 128)       0         
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 7, 7, 128)         0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 7, 7, 128)         0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 7, 7, 256)         295168    
_________________________________________________________________
activation_2 (Activation)    (None, 7, 7, 256)         0         
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 3, 3, 256)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 3, 3, 256)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 3, 3, 512)         1180160   
_________________________________________________________________
activation_3 (Activation)    (None, 3, 3, 512)         0         
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 1, 1, 512)         0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 1, 1, 512)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 512)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 64)                32832     
_________________________________________________________________
dropout_5 (Dropout)          (None, 64)                0         
_________________________________________________________________
predictions (Dense)          (None, 10)                650       
=================================================================
Total params: 1,602,058
Trainable params: 1,602,058
Non-trainable params: 0
```

### results

> train accu : 0.79, val accu : 0.8245, Epoch = 50

# train 3: better arch - same padding + more fc
### id: cifar10-11018058

### arch
```
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_45 (Conv2D)           (None, 32, 32, 32)        896       
_________________________________________________________________
conv2d_46 (Conv2D)           (None, 32, 32, 64)        18496     
_________________________________________________________________
max_pooling2d_30 (MaxPooling (None, 16, 16, 64)        0         
_________________________________________________________________
dropout_40 (Dropout)         (None, 16, 16, 64)        0         
_________________________________________________________________
conv2d_47 (Conv2D)           (None, 16, 16, 128)       73856     
_________________________________________________________________
activation_27 (Activation)   (None, 16, 16, 128)       0         
_________________________________________________________________
max_pooling2d_31 (MaxPooling (None, 8, 8, 128)         0         
_________________________________________________________________
dropout_41 (Dropout)         (None, 8, 8, 128)         0         
_________________________________________________________________
conv2d_48 (Conv2D)           (None, 8, 8, 256)         295168    
_________________________________________________________________
activation_28 (Activation)   (None, 8, 8, 256)         0         
_________________________________________________________________
max_pooling2d_32 (MaxPooling (None, 4, 4, 256)         0         
_________________________________________________________________
dropout_42 (Dropout)         (None, 4, 4, 256)         0         
_________________________________________________________________
conv2d_49 (Conv2D)           (None, 4, 4, 512)         1180160   
_________________________________________________________________
activation_29 (Activation)   (None, 4, 4, 512)         0         
_________________________________________________________________
flatten_7 (Flatten)          (None, 8192)              0         
_________________________________________________________________
dense_9 (Dense)              (None, 1024)              8389632   
_________________________________________________________________
dropout_43 (Dropout)         (None, 1024)              0         
_________________________________________________________________
dense_10 (Dense)             (None, 1024)              1049600   
_________________________________________________________________
dropout_44 (Dropout)         (None, 1024)              0         
_________________________________________________________________
predictions (Dense)          (None, 10)                10250     
=================================================================
Total params: 11,018,058
Trainable params: 11,018,058
Non-trainable params: 0
```

### result
> val accu : **0.82**
> 改变dropout后，val accu仍然无法提升