# Goal 使用feature extract来fine tuning dog, 使用inception方案

## benchmark 
> resnet-e2e: 0.76
> inception-e2e: 0.89
> random: 0.083

# Key Results
> BEST - 0.75 - (inception结构+softmax)
> end to end evaluate: top1 0.74
> MN的feature能用吗 - 能用!

## Train 1: train by mobilenet + drop0.8 + softmax120 with different optimizer
## feature round = 1
### network
```
Layer (type)                 Output Shape              Param #   
=================================================================
feature_input (InputLayer)   (None, 7, 7, 1024)        0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 50176)             0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 50176)             0         
_________________________________________________________________
predictions (Dense)          (None, 120)               6021240   
=================================================================
Total params: 6,021,240
Trainable params: 6,021,240
Non-trainable params: 0
```

### id: ft-dogs-mn-6144120
### metrics
#### Adadelta(default):  
> 0.738
> saved to `mn/ft-120-dogs-mn-6021240.h5`

### end to end evaluate
> val: top 1/top2/top5: **0.75/0.80/0.93**

## Train 2: train by mobilenet + drop0.8 +fc128 + drop0.8 + softmax120 with different optimizer

### network
```
Layer (type)                 Output Shape              Param #   
=================================================================
feature_input (InputLayer)   (None, 7, 7, 1024)        0         
_________________________________________________________________
flatten_8 (Flatten)          (None, 50176)             0         
_________________________________________________________________
dropout_8 (Dropout)          (None, 50176)             0         
_________________________________________________________________
dense_6 (Dense)              (None, 128)               6422656   
_________________________________________________________________
dropout_9 (Dropout)          (None, 128)               0         
_________________________________________________________________
predictions (Dense)          (None, 120)               15480     
=================================================================
Total params: 6,438,136
Trainable params: 6,438,136
Non-trainable params: 0
```


### id: inception-ft-dogs-mn-6438136
### metrics
#### Adadelta(default):  
> 0.738
> saved to `mn/ft-120-dogs-mn-6021240.h5`

### end to end evaluate
> val: top 1/top2/top5: **0.75/0.80/0.93**

## train 2: 使用inception 是的更加deep
### network
```
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
feature_input (InputLayer)      (None, 7, 7, 1024)   0                                            
__________________________________________________________________________________________________
mn-3x3-1x1_conv (Conv2D)        (None, 7, 7, 64)     65536       feature_input[0][0]              
__________________________________________________________________________________________________
mn-3x3-1x1_bn (BatchNormalizati (None, 7, 7, 64)     192         mn-3x3-1x1_conv[0][0]            
__________________________________________________________________________________________________
mn-3x3-1x1 (Activation)         (None, 7, 7, 64)     0           mn-3x3-1x1_bn[0][0]              
__________________________________________________________________________________________________
mn-5x5-1x1_conv (Conv2D)        (None, 7, 7, 48)     49152       feature_input[0][0]              
__________________________________________________________________________________________________
mn-3x3-3x3-1_conv (Conv2D)      (None, 7, 7, 96)     55296       mn-3x3-1x1[0][0]                 
__________________________________________________________________________________________________
mn-5x5-1x1_bn (BatchNormalizati (None, 7, 7, 48)     144         mn-5x5-1x1_conv[0][0]            
__________________________________________________________________________________________________
mn-3x3-3x3-1_bn (BatchNormaliza (None, 7, 7, 96)     288         mn-3x3-3x3-1_conv[0][0]          
__________________________________________________________________________________________________
mn-5x5-1x1 (Activation)         (None, 7, 7, 48)     0           mn-5x5-1x1_bn[0][0]              
__________________________________________________________________________________________________
mn-3x3-3x3-1 (Activation)       (None, 7, 7, 96)     0           mn-3x3-3x3-1_bn[0][0]            
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 7, 7, 1024)   0           feature_input[0][0]              
__________________________________________________________________________________________________
mn-1x1_conv (Conv2D)            (None, 7, 7, 64)     65536       feature_input[0][0]              
__________________________________________________________________________________________________
mn-5x5-5x5_conv (Conv2D)        (None, 7, 7, 64)     76800       mn-5x5-1x1[0][0]                 
__________________________________________________________________________________________________
mn-3x3-3x3-2_conv (Conv2D)      (None, 7, 7, 96)     82944       mn-3x3-3x3-1[0][0]               
__________________________________________________________________________________________________
mn-pool_conv (Conv2D)           (None, 7, 7, 32)     32768       average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
mn-1x1_bn (BatchNormalization)  (None, 7, 7, 64)     192         mn-1x1_conv[0][0]                
__________________________________________________________________________________________________
mn-5x5-5x5_bn (BatchNormalizati (None, 7, 7, 64)     192         mn-5x5-5x5_conv[0][0]            
__________________________________________________________________________________________________
mn-3x3-3x3-2_bn (BatchNormaliza (None, 7, 7, 96)     288         mn-3x3-3x3-2_conv[0][0]          
__________________________________________________________________________________________________
mn-pool_bn (BatchNormalization) (None, 7, 7, 32)     96          mn-pool_conv[0][0]               
__________________________________________________________________________________________________
mn-1x1 (Activation)             (None, 7, 7, 64)     0           mn-1x1_bn[0][0]                  
__________________________________________________________________________________________________
mn-5x5-5x5 (Activation)         (None, 7, 7, 64)     0           mn-5x5-5x5_bn[0][0]              
__________________________________________________________________________________________________
mn-3x3-3x3-2 (Activation)       (None, 7, 7, 96)     0           mn-3x3-3x3-2_bn[0][0]            
__________________________________________________________________________________________________
mn-pool (Activation)            (None, 7, 7, 32)     0           mn-pool_bn[0][0]                 
__________________________________________________________________________________________________
mn-all (Concatenate)            (None, 7, 7, 256)    0           mn-1x1[0][0]                     
                                                                 mn-5x5-5x5[0][0]                 
                                                                 mn-3x3-3x3-2[0][0]               
                                                                 mn-pool[0][0]                    
__________________________________________________________________________________________________
flatten_13 (Flatten)            (None, 12544)        0           mn-all[0][0]                     
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 12544)        0           flatten_13[0][0]                 
__________________________________________________________________________________________________
predictions (Dense)             (None, 120)          1505400     dropout_15[0][0]                 
==================================================================================================
Total params: 1,934,824
Trainable params: 1,933,896
Non-trainable params: 928
```

### metrics
### adagrad
> accu: 0.75

## evaluate
> top1/2/5: 0.70/0.86/0.94
> top1/2/5: 0.75/0.87/0.94
> top1/2/5:  ** 0.74/0.87/0.96 **